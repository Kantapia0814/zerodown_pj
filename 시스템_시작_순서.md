# ğŸš€ Zero-Downtime ì‹œìŠ¤í…œ ì‹œì‘ ìˆœì„œ

## âœ… **ë‹¨ê³„ë³„ ì²´í¬ë¦¬ìŠ¤íŠ¸**

### **1. Docker ì¼œê¸°** âœ…
```bash
# Docker Desktop ì‹¤í–‰ í›„ ì™„ì „íˆ ë¡œë”© ëŒ€ê¸°
docker --version
docker ps
```

### **2. âš ï¸ Consul ì„œë²„ ë¨¼ì € ì¼œê¸°** (ìˆœì„œ ì¤‘ìš”!)
```bash
# í„°ë¯¸ë„ 1 (Consul ì „ìš©)
consul agent -dev -bind=172.17.187.181 -client=0.0.0.0

# í™•ì¸
curl http://localhost:8500/v1/status/leader
```

### **3. Nomad ì„œë²„ ì¼œê¸°**
```bash
# í„°ë¯¸ë„ 2 (Nomad ì „ìš©)
nomad agent -dev -bind=172.17.187.181

# í™•ì¸
nomad status
```

### **4. Nginx + Auto-reload ì¼œê¸°** (ì¤‘ìš”í•œ ì¶”ê°€!)
```bash
# Nginx ì‹œì‘
sudo systemctl start nginx

# í„°ë¯¸ë„ 3 (nginx-auto-reload ì „ìš©)
# ì‹œìŠ¤í…œì— ì„¤ì¹˜ëœ ìŠ¤í¬ë¦½íŠ¸ ì§ì ‘ ì‹¤í–‰
nginx-auto-reload.sh

# ë˜ëŠ” í”„ë¡œì íŠ¸ í´ë”ì—ì„œ ì‹¤í–‰í•˜ë ¤ë©´:
# cd /mnt/c/Users/hongs/IdeaProjects/kantapia_pj
# chmod +x scripts/nginx-auto-reload.sh  
# ./scripts/nginx-auto-reload.sh
```

### **5. consul-template ì‹¤í–‰** (ì¤‘ìš”!)
```bash
# í„°ë¯¸ë„ 4 (consul-template ì „ìš©)
consul-template \
  -template="/etc/nginx/conf.d/hello-service.ctmpl:/etc/nginx/conf.d/hello-service.conf:echo 'Config updated'" \
  -consul-addr="127.0.0.1:8500" &
```

### **6. ì„œë¹„ìŠ¤ ë°°í¬í•˜ê¸° + ë“±ë¡ ëŒ€ê¸°**
```bash
# í„°ë¯¸ë„ 5 (ë©”ì¸ ì‘ì—…ìš©)
cd /mnt/c/Users/hongs/IdeaProjects/kantapia_pj

# Nomad ì£¼ì†Œ ì„¤ì • (ì¤‘ìš”!)
export NOMAD_ADDR="http://172.17.187.181:4646"

# ì„œë¹„ìŠ¤ ë°°í¬
nomad job run hello-service-dynamic.nomad

# ì¤‘ìš”: ì„œë¹„ìŠ¤ ë“±ë¡ ëŒ€ê¸° (30ì´ˆ-1ë¶„)
echo "ì„œë¹„ìŠ¤ ë“±ë¡ ëŒ€ê¸° ì¤‘..."
sleep 30
```

### **7. ìƒíƒœ í™•ì¸ í›„ í…ŒìŠ¤íŠ¸**
```bash
# ìƒíƒœ í™•ì¸
./toggle_version_consul_true_zero_downtime.sh status

# API í…ŒìŠ¤íŠ¸
curl http://localhost:8080/hello
curl http://localhost:8080/standby

# ë¶€í•˜ í…ŒìŠ¤íŠ¸ + switch/deploy ë™ì‹œ í…ŒìŠ¤íŠ¸
k6 run k6-test.js &
./toggle_version_consul_true_zero_downtime.sh switch
```

---

## ğŸš¨ **ì¤‘ìš” í¬ì¸íŠ¸**

1. **ìˆœì„œ ì—„ìˆ˜**: Consul â†’ Nomad â†’ Nginx ìˆœì„œ ë°˜ë“œì‹œ ì§€í‚¤ê¸°
2. **ëŒ€ê¸° ì‹œê°„**: ê° ë‹¨ê³„ë§ˆë‹¤ 2-3ë¶„ì”© ì•ˆì •í™” ëŒ€ê¸°
3. **í„°ë¯¸ë„ ê´€ë¦¬**: ê° ì„œë¹„ìŠ¤ë³„ë¡œ ë³„ë„ í„°ë¯¸ë„ ì‚¬ìš©
4. **IP ì£¼ì†Œ**: 172.17.187.181ì„ ìì‹ ì˜ IPë¡œ ë³€ê²½

## âœ… **ì™„ë£Œ í™•ì¸**

- [ ] Docker ì‹¤í–‰ë¨
- [ ] Consul (localhost:8500) ì‘ë‹µ
- [ ] Nomad (localhost:4646) ì‘ë‹µ  
- [ ] nginx-auto-reload ì‹¤í–‰ì¤‘
- [ ] consul-template ì‹¤í–‰ì¤‘  
- [ ] hello-service ë°°í¬ë¨
- [ ] API (localhost:8080) ì‘ë‹µ
- [ ] k6 í…ŒìŠ¤íŠ¸ í†µê³¼

**ğŸ¯ ëª¨ë“  ì²´í¬ê°€ ì™„ë£Œë˜ë©´ Zero-Downtime ì‹œìŠ¤í…œ ì¤€ë¹„ ì™„ë£Œ!**